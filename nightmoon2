#!/bin/bash
# High-Performance Strict Mode
set -euo pipefail
IFS=$'\n\t'

# Telemetry Wrapper
log_event() {
    echo "[$(date +'%Y-%m-%dT%H:%M:%S%z')] $1"
}

log_event "ðŸš€ INITIATING MESH OPTIMIZATION..."

# Efficient stream processing without temp files
active_nodes=$(netstat -an | awk '/ESTABLISHED/ {print $5}' | cut -d: -f1 | sort -u)

for node in $active_nodes; do
    # Perform non-blocking health check
    ping -c 1 -W 1 "$node" > /dev/null && log_event "Node $node: REACHABLE" || log_event "Node $node: ERROR"
done

log_event "âœ… SYSTEM OPTIMIZED."
