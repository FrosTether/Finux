<!DOCTYPE html>
<html lang="en">
<head>
  <title>FrostMines | Hatchling üê•</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">
  <meta charset="UTF-8">
  <style>
    :root {
      --bg: #010301; --grid: #000; --cell: #0a1a0a;
      --gold: #ffd700; --gold-d: #b8860b; --cyan: #00e5ff;
      --purple: #d500f9; --green: #00ff41; --text: #00ff41;
      --sb: env(safe-area-inset-bottom, 24px);
    }
    * { margin:0; padding:0; box-sizing:border-box; -webkit-tap-highlight-color:transparent; user-select:none; touch-action:none; }
    body {
      background: var(--bg); color: var(--text); font-family: 'Courier New', monospace;
      height: 100dvh; overflow: hidden; display: flex; flex-direction: column; align-items: center;
      padding: 10px 10px var(--sb) 10px; gap: 8px;
    }
    .h { width: 100%; max-width: 420px; padding: 10px; background: rgba(0,255,65,0.1); border: 1px solid var(--green); border-radius: 10px; font-size: 14px; font-weight: bold; display: flex; justify-content: space-between; }
    .stats { width: 100%; max-width: 420px; padding: 10px; background: rgba(255,215,0,0.05); border: 1px solid var(--gold-d); border-radius: 10px; display: grid; grid-template-columns: repeat(4, 1fr); gap: 4px; text-align: center; font-size: 11px; }
    .stats span { color: var(--gold); font-weight: bold; }
    #streak-viz { display: flex; gap: 8px; justify-content: center; margin-bottom: 2px; }
    .dot { width: 8px; height: 8px; border-radius: 50%; background: rgba(0, 229, 255, 0.1); border: 1px solid rgba(0, 229, 255, 0.3); }
    .dot.active { background: var(--cyan); box-shadow: 0 0 10px var(--cyan); }
    #g { width: 100%; max-width: 400px; aspect-ratio: 1/1; background: var(--grid); border: 3px solid var(--green); border-radius: 12px; padding: 4px; display: grid; grid-template-columns: repeat(10, 1fr); gap: 2px; box-shadow: 0 0 20px rgba(0,255,65,0.15); margin-bottom: 100px; }
    .c { background: var(--cell); border: 1px solid #111; border-radius: 3px; transition: 0.15s; position: relative; }
    .c.f { background: linear-gradient(135deg, var(--gold), var(--gold-d)); border-color: var(--gold); box-shadow: 0 0 10px rgba(255,215,0,0.6); }
    .mining-btn { position: fixed; bottom: calc(var(--sb) + 16px); padding: 14px 35px; background: var(--purple); border: 2px solid var(--purple); border-radius: 30px; color: #fff; font-weight: bold; box-shadow: 0 0 20px rgba(213,0,249,0.5); z-index: 100; transition: 0.3s; }
    .mining-btn.active { background: #00c853; border-color: #64dd17; box-shadow: 0 0 25px rgba(100,221,23,0.6); }
    #notif { position: fixed; top: 40%; background: linear-gradient(135deg, var(--cyan), var(--purple)); padding: 20px; border-radius: 15px; color: #fff; font-weight: bold; transform: scale(0); transition: 0.5s; z-index: 999; }
    #notif.show { transform: scale(1); }
  </style>
</head>
<body onload="init()">

<div class="h"><div>üß¨ FrostMines | Hatchling üê•</div><div id="utc">UTC: --:--:--</div></div>
<div class="stats">
  <div id="streak-viz"><div class="dot"></div><div class="dot"></div><div class="dot"></div></div>
  <div>FTC: <span id="ftc">13.370</span></div>
  <div>HILL: <span id="score">0</span></div>
  <div>üê•: <span id="timer">150s</span></div>
</div>
<div id="g"></div>
<button class="mining-btn" id="mine-btn" onclick="tL()">MINING</button>
<div id="notif"></div>

<script>
let G=new Uint8Array(100), R=Number(localStorage.getItem('ftc'))||13.37, SCORE=0, HT=150, ENG=false, A$={c:null, hum:null}, drag=null, streak=0;

function tL() {
  if(!A$.c) A$.c = new (window.AudioContext || window.webkitAudioContext)();
  const b = document.getElementById('mine-btn');
  ENG = !ENG;
  if(ENG) { b.innerText="MINING ACTIVE"; b.classList.add('active'); startHum(); }
  else { b.innerText="MINING"; b.classList.remove('active'); stopHum(); }
}

function startHum() { humOsc = A$.c.createOscillator(); humOsc.type='sine'; humOsc.frequency.value=7.83; const g = A$.c.createGain(); g.gain.value=0.05; humOsc.connect(g).connect(A$.c.destination); humOsc.start(); A$.hum=humOsc; }
function stopHum() { if(A$.hum) { A$.hum.stop(); A$.hum=null; } }

function init() {
  const gD = document.getElementById('g'); gD.innerHTML = ''; G.fill(0);
  for (let i=0; i<100; i++) {
    const c = document.createElement('div'); c.className = 'c'; c.dataset.idx = i;
    c.addEventListener('touchstart', e => { if(ENG && G[i]) drag=i; });
    gD.appendChild(c);
  }
  document.addEventListener('touchmove', e => {
    if(drag === null) return;
    const t = e.touches[0]; const el = document.elementFromPoint(t.clientX, t.clientY);
    const cell = el?.closest('.c'); if(!cell) return;
    const ni = +cell.dataset.idx;
    if(ni !== drag && !G[ni]) {
      G[drag]=0; G[ni]=1; document.getElementById('g').children[drag].classList.remove('f');
      document.getElementById('g').children[ni].classList.add('f'); drag=ni;
      pS(1800, 'sine', 0.1); if(navigator.vibrate) navigator.vibrate(15);
    }
  });
  document.addEventListener('touchend', () => { if(drag!==null) { checkLines(); drag=null; } });
  sp(8); updateUI();
  setInterval(() => { if(ENG) { HT--; if(HT<=0) { HT=150; R+=6.685; checkHatch(); } updateUI(); } updateClock(); }, 1000);
}

function pS(f,t,d) { const o=A$.c.createOscillator(); const g=A$.c.createGain(); o.type=t; o.frequency.value=f; g.gain.setValueAtTime(0.1, A$.c.currentTime); g.gain.exponentialRampToValueAtTime(0.01, A$.c.currentTime+d); o.connect(g).connect(A$.c.destination); o.start(); o.stop(A$.c.currentTime+d); }

function checkLines() {
  let cl=0;
  for(let r=0; r<10; r++) { let f=true; for(let c=0;c<10;c++) if(!G[r*10+c])f=false; if(f) { cl++; for(let c=0;c<10;c++) G[r*10+c]=0; } }
  if(cl) { SCORE += cl*100; R+=0.01; sp(cl*4); renderGrid(); }
}

function checkHatch() {
  if(SCORE > 800) { streak++; if(streak>=3) { showNotif("RARE SPRITE! ‚ùÑÔ∏è"); streak=0; } else showNotif("HATCHED! üê•"); }
  else streak=0; SCORE=0; updateStreak();
}

function updateStreak() { const ds=document.querySelectorAll('.dot'); ds.forEach((d,i) => d.className = i<streak ? 'dot active' : 'dot'); }
function showNotif(txt) { const n=document.getElementById('notif'); n.innerText=txt; n.classList.add('show'); setTimeout(()=>n.classList.remove('show'), 2500); }
function sp(n) { let p=0; while(p<n) { let i=Math.floor(Math.random()*100); if(!G[i]) { G[i]=1; p++; } } renderGrid(); }
function renderGrid() { G.forEach((v,i) => document.getElementById('g').children[i].className = v ? 'c f' : 'c'); }
function updateUI() { document.getElementById('ftc').innerText = R.toFixed(3); document.getElementById('score').innerText = SCORE; document.getElementById('timer').innerText = HT+"s"; }
function updateClock() { const d=new Date(); document.getElementById('utc').innerText = `UTC: ${d.getUTCHours()}:${d.getUTCMinutes()}:${d.getUTCSeconds()}`; }
</script>
</body>
</html>
